# Bash completion for MyFVM
# Source this file or add to your bash completion directory

_myfvm_completion() {
    local cur prev opts
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    
    # Main commands
    local commands="install uninstall switch list current versions cleanup cache help version status update"
    
    # Cache subcommands
    local cache_commands="status clear refresh"
    
    # Version patterns (common Flutter versions)
    local versions="3.24.5 3.24.3 3.24.1 3.22.6 3.22.5 3.22.4 3.22.3 3.22.2 3.22.1 3.22.0 3.21.0 3.20.6 3.20.5 3.20.4 3.20.3 3.20.2 3.20.1 3.20.0 3.19.6 3.19.5 3.19.4 3.19.3 3.19.2 3.19.1 3.19.0"
    
    case ${COMP_CWORD} in
        1)
            # First argument - show main commands
            COMPREPLY=( $(compgen -W "${commands}" -- ${cur}) )
            return 0
            ;;
        2)
            # Second argument - context dependent
            case ${prev} in
                install|uninstall|switch)
                    # For install/uninstall/switch, suggest versions
                    COMPREPLY=( $(compgen -W "${versions}" -- ${cur}) )
                    return 0
                    ;;
                cache)
                    # For cache, suggest cache subcommands
                    COMPREPLY=( $(compgen -W "${cache_commands}" -- ${cur}) )
                    return 0
                    ;;
                versions)
                    # For versions, suggest version validation
                    COMPREPLY=( $(compgen -W "${versions}" -- ${cur}) )
                    return 0
                    ;;
            esac
            ;;
        3)
            # Third argument - for cache commands
            if [[ ${COMP_WORDS[1]} == "cache" ]]; then
                # Cache commands don't take additional arguments
                COMPREPLY=()
                return 0
            fi
            ;;
    esac
    
    return 0
}

# Register completion for myfvm.sh
if [ -n "$BASH_VERSION" ]; then
    # Bash completion
    complete -F _myfvm_completion myfvm.sh
    complete -F _myfvm_completion flutter-install
    complete -F _myfvm_completion flutter-uninstall
    complete -F _myfvm_completion flutter-switch
    complete -F _myfvm_completion flutter-versions
    complete -F _myfvm_completion flutter-cache
elif [ -n "$ZSH_VERSION" ]; then
    # Zsh completion
    compdef _myfvm_completion myfvm.sh
    compdef _myfvm_completion flutter-install
    compdef _myfvm_completion flutter-uninstall
    compdef _myfvm_completion flutter-switch
    compdef _myfvm_completion flutter-versions
    compdef _myfvm_completion flutter-cache
fi
